{"version":3,"sources":["webpack:///src/components/selector/index.vue","webpack:///./src/components/selector/index.vue?9f65","webpack:///./src/components/selector/index.vue"],"names":["selector","name","props","id","type","String","default","text","searchKey","multiple","Boolean","placeholder","filterable","remote","data","load","Array","url","extraParams","Object","onSelectionChanged","Function","disabledBol","disabled","clearable","searchKey0","selections","selected","loading","mappedData","mounted","_this","this","setTimeout","init","watch","methods","loadChanged","filter","d","entries_default","map","mappingData","loadParams","length","remoteMethod","_this2","forEach","getSelection","_this3","push","s","clear","_this4","trim","params","assign_default","http","get","then","catch","onChange","components_selector","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","padding","border","attrs","remote-method","remove-tag","on","change","model","value","callback","$$v","expression","_l","item","index","key","label","indexOf","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/23.20d0ebc275391e123e4b.js","sourcesContent":["<template>\n  <el-select :multiple=\"multiple\" :filterable=\"filterable\" :remote=\"remote\" :clearable=\"clearable\"\n             :placeholder=\"placeholder || (multiple ? '请输入关键字搜索' : '请选择')\" :remote-method=\"remoteMethod\" :loading=\"loading\"\n             @change=\"onChange\" v-model=\"selected\" :remove-tag=\"onChange\" :clear=\"remoteMethod\"\n             class=\"form-control\" style=\"padding: 0;border: 0;\" :disabled=\"disabledBol\">\n    <el-option\n      v-for=\"(item, index) of selections\"\n      :key=\"index\"\n      :label=\"item[text]\"\n      :value=\"item[id]\"\n      :disabled=\"disabled.indexOf(item[id]) > -1\">\n    </el-option>\n  </el-select>\n</template>\n\n/**\n* @author ： 李银 on 2018-10-31 09:18:18\n* 依据element-ui改装，原版请访问：http://element-cn.eleme.io/#/zh-CN/component/select\n*\n* 入参：\n* id:String             - 在数据中的主键名称，如data为：[{a:1,b:2}],如果id为a，那么1为这个数据的主键，默认：id\n* text:String           - 在数据中的用于显示的名称，如data为：[{a:1,b:2}],如果text为b，那么2为这个数据的显示元素，默认text\n* multiple:Boolean      - 是否多选，默认：false\n* placeholder:String    - 占位符，默认：请选择\n* filterable:Boolean    - 是否可搜索，默认：false\n* remote:Boolean        - 是否为远程搜索，默认：false\n* data:Array/Object     - 可选项数据：必须至少包含id，text字段，id用于唯一标识，text字段用于展示，在remote为false下生效，如果data是object，则系统自动转化为Array形式，key为id，value为text\n* url:String            - 远程请求数据url，返回数据格式和data一致，必须接收@searchKey 作为搜索参数\n* searchKey:String      - 远程请求数据的参数名，默认text\n* extraParams           - 远程请求数据的额外参数\n* load:Array            - 默认加载已选择项，id即可，如：[1,2,3,4]\n*\n* api:\n* getSelection          - 获取当前选择的项\n* clear                 - 清空选项\n*\n* 回调：\n* onSelectionChanged()  - 当前选择项发生变化时触发，参数为当前所有选择的项；\n**/\n<script>\nimport { xhr } from '@/config/api/http'\n\nexport default {\n  name: 'selector',\n  props: {\n    id: {\n      type: String,\n      default: 'id'\n    },\n    text: {\n      type: String,\n      default: 'text'\n    },\n    searchKey: {\n      type: String,\n      default: null\n    },\n    multiple: {\n      type: Boolean,\n      default: false\n    },\n    placeholder: {\n      type: String,\n      default: null\n    },\n    filterable: {\n      type: Boolean,\n      default: false\n    },\n    remote: {\n      type: Boolean,\n      default: false\n    },\n    data: null,\n    load: {\n      type: Array,\n      default: null\n    },\n    url: null,\n    extraParams: {\n      type: Object,\n      default: null\n    },\n    onSelectionChanged: {\n      type: Function,\n      default: null\n    },\n    disabledBol: {\n      type: Boolean,\n      default: false\n    },\n    disabled: {\n      type: Array,\n      default: () => []\n    },\n    clearable: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data () {\n    return {\n      searchKey0: null,\n      selections: [],\n      selected: null,\n      loading: false,\n      mappedData: {}\n    }\n  },\n  mounted () {\n    setTimeout(() => {\n      this.init()\n    }, 100)\n  },\n  watch: {\n    load: 'loadChanged'\n  },\n  methods: {\n    loadChanged () {\n      const load = (this.load || []).filter(d => d != null)\n      if (this.multiple) {\n        this.selected = load\n      } else {\n        this.selected = load[0]\n      }\n      return load\n    },\n    init () {\n      this.searchKey0 = this.searchKey || this.text\n      const load = this.loadChanged()\n      if (this.data) {\n        if (!(this.data instanceof Array)) {\n          this.selections = Object.entries(this.data)\n            .map(d => {\n              return {id: d[0], text: d[1]}\n            })\n        } else {\n          this.selections = this.data\n        }\n        this.mappingData()\n      } else if (this.remote && this.url) {\n        const loadParams = {}\n        if (load.length > 0) {\n          loadParams['rows'] = load.length\n          loadParams[this.id] = load\n          loadParams[`${this.id}List`] = load\n        }\n        this.remoteMethod('', loadParams, load)\n      }\n    },\n    mappingData () {\n      this.mappedData = {}\n      this.selections.forEach((d) => {\n        this.mappedData[d[this.id]] = d\n      })\n    },\n    getSelection () {\n      let selected = []\n      if (this.multiple) {\n        // 多选\n        this.selected.forEach(d => selected.push(this.mappedData[d]))\n      } else {\n        // 单选\n        const s = this.mappedData[this.selected]\n        selected = s ? [this.mappedData[this.selected]] : []\n      }\n      return selected\n    },\n    clear () {\n      this.selected = this.multiple ? [] : null\n    },\n    remoteMethod (text, loadParams) {\n      if (this.remote && this.url) {\n        text = (text || '').trim()\n\n        this.loading = true\n        let params = {}\n        params[this.searchKey0] = text\n        params = Object.assign(params, loadParams, this.extraParams);\n        // 如果url是字符串，则自行请求结果，否则直接执行url方法\n        (typeof this.url === 'string' ? xhr.get(this.url, {params}).then((d) => {\n          this.loading = false\n          this.selections = d.data.data\n          this.mappingData()\n        }) : this.url(params)\n          .then((d) => {\n            this.loading = false\n            this.selections = d\n            this.mappingData()\n          }))\n          .catch(() => {\n            this.loading = false\n            this.selections = []\n            this.mappingData()\n          })\n      }\n    },\n    onChange () {\n      const selected = this.getSelection()\n      if (selected.length === 0) {\n        this.remoteMethod()\n      }\n      // 通知外部选择项已修改\n      if (this.onSelectionChanged) {\n        this.onSelectionChanged(selected)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n  @import 'index.scss';\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/selector/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-select',{staticClass:\"form-control\",staticStyle:{\"padding\":\"0\",\"border\":\"0\"},attrs:{\"multiple\":_vm.multiple,\"filterable\":_vm.filterable,\"remote\":_vm.remote,\"clearable\":_vm.clearable,\"placeholder\":_vm.placeholder || (_vm.multiple ? '请输入关键字搜索' : '请选择'),\"remote-method\":_vm.remoteMethod,\"loading\":_vm.loading,\"remove-tag\":_vm.onChange,\"clear\":_vm.remoteMethod,\"disabled\":_vm.disabledBol},on:{\"change\":_vm.onChange},model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}},_vm._l((_vm.selections),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item[_vm.text],\"value\":item[_vm.id],\"disabled\":_vm.disabled.indexOf(item[_vm.id]) > -1}})}),1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-341549ae\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/selector/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-341549ae\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-341549ae\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-341549ae\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/selector/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}