webpackJsonp([38],{DzQl:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("aA9S"),a=n.n(r),s=n("3cXf"),i=n.n(s),o=n("lC5x"),l=n.n(o),d=n("J0Oq"),c=n.n(d),u=n("0Njg"),p=n("R2SV"),h={props:{onOk:{type:Function,default:function(){}}},data:function(){return{nodeId:null,node:{sleep:0,interfaceId:null,interfaceName:null,history:!1,hash:null,method:null,url:null,parameters:null,preParams:null,headers:[],javascript:null,returns:null,java:null},generatedReturns:null,interfacesVersionedSimpleListApi:u.M,interfacesSimpleListApi:u.K,functionListApi:u.t}},methods:{onSelectInterface:function(e){var t=this;return c()(l.a.mark(function n(){var r;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e[0]||{},t.node.interfaceId=r.id,t.node.interfaceName=r.name,t.node.hash=null,n.t0=t,n.next=7,t.getConfiguredParameters(r.id,r);case 7:n.t1=n.sent,n.t0.setInterfaces.call(n.t0,n.t1);case 9:case"end":return n.stop()}},n,t)}))()},getConfiguredParameters:function(e,t){var n=this;return c()(l.a.mark(function r(){var a;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,Object(u.v)(e);case 4:return(a=n.sent)&&a.cusParameters?(t.parameters=JSON.parse(a.cusParameters),t.javascript=null!=a.javascript?JSON.parse(a.javascript):null,t.preParams=JSON.parse(a.preParams),console.log(t.javascript,i()(t.javascript))):t.parameters=Object(p.d)(t.parameters),n.abrupt("return",t);case 7:case"end":return n.stop()}},r,n)}))()},onSelectHistoryInterface:function(e){var t=this;return c()(l.a.mark(function n(){var r;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e[0]||{},t.node.hash=r.hash,n.t0=t,n.next=5,t.getConfiguredParameters(r.id,r);case 5:n.t1=n.sent,n.t0.setInterfaces.call(n.t0,n.t1);case 7:case"end":return n.stop()}},n,t)}))()},setInterfaces:function(e){this.node.url=e.url,this.node.method=e.method,this.node.java=e.java,this.node.sleep=e.sleep,this.node.parameters=e.parameters,this.node.javascript=e.javascript,this.node.preParams=e.preParams||[],e.returns?(this.node.returns=JSON.parse(e.returns),this.generatedReturns=Object(p.e)(this.node.returns)):(this.node.returns=null,this.generatedReturns=null),this.$set(this.node,"headers",e.end.header?JSON.parse(e.end.header):[])},open:function(e,t){var n=e.data||{};this.nodeId=e.id,this.node.interfaceId=n.interfaceId,this.node.interfaceName=n.interfaceName,this.node.history=n.history||!1,this.node.hash=n.hash,this.node.headers=n.headers||[],this.node.parameters=n.parameters||[],this.node.preParams=n.preParams||[],this.node.javascript=n.javascript,this.node.java=n.java,this.node.url=n.url,this.node.sleep=n.sleep,this.node.method=n.method,n.returns?(this.node.returns=n.returns,this.generatedReturns=Object(p.e)(this.node.returns)):(this.node.returns=null,this.generatedReturns=null),this.$refs.editNodeDialog.open()},confirm:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.onOk&&e.onOk(a()({},e.node)),e.$refs.editNodeDialog.close())})},paste:function(e){Object(p.b)(e,this.node.parameters)},addPreParams:function(){this.node.preParams.push({key:"",value:"",type:"text"})},addHeader:function(){this.node.headers.push({key:"",value:""})},delHeader:function(e){this.node.headers.splice(e,1)}},mounted:function(){this.$el.addEventListener("paste",this.paste)},components:{"v-dialog":function(){return n.e(29).then(n.bind(null,"j9Pd"))},"v-selector":function(){return n.e(31).then(n.bind(null,"qNHp"))},"v-jsonformatter":function(){return n.e(30).then(n.bind(null,"9YOq"))},"v-parameter-input":function(){return n.e(33).then(n.bind(null,"WfCw"))}}},f={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-dialog",{ref:"editNodeDialog",attrs:{title:"配置节点，当前节点编号："+e.nodeId,ok:e.confirm,width:1e3}},[n("el-form",{ref:"form",staticClass:"edit-node-dialog",attrs:{slot:"body",model:e.node,"label-width":"8em"},slot:"body"},[n("el-form-item",{attrs:{prop:"interfaceId",label:"选择一个接口",required:"",rules:[{required:!0,message:"请选择一个接口",trigger:["blur","change"]}]}},[n("v-selector",{staticStyle:{width:"666px"},attrs:{id:"id",text:"complexName",searchKey:"name",onSelectionChanged:e.onSelectInterface,filterable:!0,remote:!0,placeholder:"请选择一个接口（可输入名称进行搜索）",load:e.node.interfaceId?[e.node.interfaceId]:null,url:e.interfacesSimpleListApi}}),e._v(" "),n("el-input",{staticClass:"hidden",model:{value:e.node.interfaceId,callback:function(t){e.$set(e.node,"interfaceId",t)},expression:"node.interfaceId"}}),e._v(" "),n("el-checkbox",{model:{value:e.node.history,callback:function(t){e.$set(e.node,"history",t)},expression:"node.history"}},[e._v("使用历史版本")])],1),e._v(" "),e.node.history?n("el-form-item",{attrs:{label:"历史接口"}},[n("v-selector",{attrs:{id:"hash",text:"name",onSelectionChanged:e.onSelectHistoryInterface,placeholder:"请选择一个历史版本（不选择，当前接口作为副本）",remote:!0,load:e.node.hash?[e.node.hash]:null,url:e.interfacesVersionedSimpleListApi,extraParams:e.node.interfaceId?{interfacesId:e.node.interfaceId}:{interfacesId:-1}}})],1):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"访问类型:"}},[n("div",[e._v(e._s(e.node.method))])]):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"接口地址:"}},[n("div",[e._v(e._s(e.node.url))])]):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"休眠"}},[n("el-input",{staticStyle:{display:"inline-block",width:"100px"},attrs:{placeholder:"0"},model:{value:e.node.sleep,callback:function(t){e.$set(e.node,"sleep",t)},expression:"node.sleep"}}),e._v("　秒之后运行\n        ")],1):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"必备Header:"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:"",size:"small"},on:{click:function(t){return e.addHeader()}}}),e._v(" "),e.node.headers?n("el-form",e._l(e.node.headers,function(t,r){return n("el-form-item",{key:r},[n("el-input",{staticClass:"param-key",attrs:{placeholder:"请输入headers参数名"},model:{value:t.key,callback:function(n){e.$set(t,"key",n)},expression:"h.key"}},[n("template",{slot:"prepend"},[n("span",[e._v("参数名")])])],2),e._v(" "),n("span",{staticClass:"v-top"},[e._v("=")]),e._v(" "),n("el-input",{staticClass:"param-value",attrs:{placeholder:"请输入headers参数值"},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"h.value"}},[n("template",{slot:"prepend"},[n("span",[e._v("参数值")])])],2),e._v(" "),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"small"},on:{click:function(t){return e.delHeader(r)}}})],1)}),1):e._e()],1):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"预置参数:"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:"",size:"small"},on:{click:function(t){return e.addPreParams()}}}),e._v(" "),n("v-parameter-input",{attrs:{parameters:e.node.preParams}})],1):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"接口参数:"}},[n("v-parameter-input",{attrs:{parameters:e.node.parameters}})],1):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"返回值数据结构:"}},[e.generatedReturns?n("v-jsonformatter",{attrs:{json:e.generatedReturns,"min-height":100}}):e._e()],1):e._e(),e._v(" "),e.node.interfaceId?n("el-form-item",{attrs:{label:"检查点:"}},[n("el-input",{attrs:{placeholder:"注：本接口的调用结果将存入$"+e.nodeId+"和$this中。\n另外可以获取上游节（以及上游的上游）点带来的数据，如：$anotherNode.xx\n在这里写入一些检查点脚本，示例：\n\nassert($this.name != null, '返回名称不能为空！')\nassert($"+e.nodeId+".id != null, '返回id不能为空！')\nassert($"+e.nodeId+".quantity > 0, '数量必须大于等于零！')\n\n如果报错了，那么整个流程将被终止。",rows:18,type:"textarea"},model:{value:e.node.javascript,callback:function(t){e.$set(e.node,"javascript",t)},expression:"node.javascript"}})],1):e._e()],1)],1)],1)},staticRenderFns:[]};var m=n("C7Lr")(h,f,!1,function(e){n("plAF")},"data-v-1e81b56f",null);t.default=m.exports},plAF:function(e,t){}});
//# sourceMappingURL=38.699ef60bec8ca2742fe4.js.map