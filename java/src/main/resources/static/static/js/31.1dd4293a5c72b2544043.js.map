{"version":3,"sources":["webpack:///src/components/selector/index.vue","webpack:///./src/components/selector/index.vue?71ce","webpack:///./src/components/selector/index.vue"],"names":["selector","name","props","id","type","String","default","text","searchKey","multiple","Boolean","placeholder","filterable","remote","data","load","Array","url","extraParams","Object","onSelectionChanged","Function","disabledBol","disabled","clearable","searchKey0","selections","selected","loading","params","mappedData","mounted","_this","this","setTimeout","init","watch","filter","d","concat","sort","join","loadChanged","stringify_default","methods","loadParams","length","p","_this2","remoteMethod","s","indexOf","_setSelectedAsLoad","clear","_this3","loadData","_this4","entries_default","map","forEach","getSelection","_this5","push","_this6","trim","assign_default","http","get","then","extra","catch","onChange","components_selector","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","padding","border","attrs","remote-method","remove-tag","on","change","model","value","callback","$$v","expression","_l","item","index","key","label","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/31.1dd4293a5c72b2544043.js","sourcesContent":["<template>\n  <el-select :multiple=\"multiple\" :filterable=\"filterable\" :remote=\"remote\" :clearable=\"clearable\"\n             :placeholder=\"placeholder || (multiple ? '请输入关键字搜索' : '请选择')\" :remote-method=\"remoteMethod\" :loading=\"loading\"\n             @change=\"onChange\" v-model=\"selected\" :remove-tag=\"onChange\" :clear=\"remoteMethod\"\n             class=\"form-control\" style=\"padding: 0;border: 0;\" :disabled=\"disabledBol\">\n    <el-option\n      v-for=\"(item, index) of selections\"\n      :key=\"index\"\n      :label=\"item[text]\"\n      :value=\"item[id]\"\n      :disabled=\"disabled.indexOf(item[id]) > -1\">\n    </el-option>\n  </el-select>\n</template>\n\n/**\n* @author ： 李银 on 2018-10-31 09:18:18\n* 依据element-ui改装，原版请访问：http://element-cn.eleme.io/#/zh-CN/component/select\n*\n* 入参：\n* id:String             - 在数据中的主键名称，如data为：[{a:1,b:2}],如果id为a，那么1为这个数据的主键，默认：id\n* text:String           - 在数据中的用于显示的名称，如data为：[{a:1,b:2}],如果text为b，那么2为这个数据的显示元素，默认text\n* multiple:Boolean      - 是否多选，默认：false\n* placeholder:String    - 占位符，默认：请选择\n* filterable:Boolean    - 是否可搜索，默认：false\n* remote:Boolean        - 是否为远程搜索，默认：false\n* data:Array/Object     - 可选项数据：必须至少包含id，text字段，id用于唯一标识，text字段用于展示，在remote为false下生效，如果data是object，则系统自动转化为Array形式，key为id，value为text\n* url:String            - 远程请求数据url，返回数据格式和data一致，必须接收@searchKey 作为搜索参数\n* searchKey:String      - 远程请求数据的参数名，默认text\n* extraParams           - 远程请求数据的额外参数\n* load:Array            - 默认加载已选择项，id即可，如：[1,2,3,4]\n*\n* api:\n* getSelection          - 获取当前选择的项\n* clear                 - 清空选项\n*\n* 回调：\n* onSelectionChanged()  - 当前选择项发生变化时触发，参数为当前所有选择的项；\n**/\n<script>\nimport { xhr } from '@/config/api/http'\n\nexport default {\n  name: 'selector',\n  props: {\n    id: {\n      type: String,\n      default: 'id'\n    },\n    text: {\n      type: String,\n      default: 'text'\n    },\n    searchKey: {\n      type: String,\n      default: null\n    },\n    multiple: {\n      type: Boolean,\n      default: false\n    },\n    placeholder: {\n      type: String,\n      default: null\n    },\n    filterable: {\n      type: Boolean,\n      default: false\n    },\n    remote: {\n      type: Boolean,\n      default: false\n    },\n    data: null,\n    load: {\n      type: Array,\n      default: null\n    },\n    url: null,\n    extraParams: {\n      type: Object,\n      default: null\n    },\n    onSelectionChanged: {\n      type: Function,\n      default: null\n    },\n    disabledBol: {\n      type: Boolean,\n      default: false\n    },\n    disabled: {\n      type: Array,\n      default: () => []\n    },\n    clearable: {\n      type: Boolean,\n      default: true\n    }\n  },\n  data () {\n    return {\n      searchKey0: null,\n      selections: [],\n      selected: null,\n      loading: false,\n      params: {},\n      mappedData: {}\n    }\n  },\n  mounted () {\n    setTimeout(() => {\n      this.init()\n    }, 100)\n  },\n  watch: {\n    load () {\n      const load = (this.load || []).filter(d => d != null)\n      const selected = this.multiple ? [].concat(this.selected) : (this.selected == null ? [] : [this.selected])\n      if (load.sort().join('|_|') === selected.sort().join('|_|')) {\n        // not changed\n        return\n      }\n      this.loadChanged()\n    },\n    extraParams () {\n      const extraParams = this.extraParams || {}\n      const params = this.params || {}\n      if (JSON.stringify(extraParams) !== JSON.stringify(params)) {\n        this.params = extraParams\n        this.loadChanged(-1)\n      }\n    }\n  },\n  methods: {\n    loadParams (load) {\n      const loadParams = {}\n      if (load.length > 0) {\n        loadParams['rows'] = load.length\n        loadParams[this.id] = load\n        loadParams[`${this.id}List`] = load\n      }\n      return loadParams\n    },\n    loadChanged (p) {\n      const load = (this.load || []).filter(d => d != null)\n      if (p === -1) {\n        // 初始化\n        this.remoteMethod('', this.loadParams(load))\n      } else if (load.length > 0) {\n        // 后面修改load, 先看自己数据里面是否有当前数据，如果有则直接加载，没有就请求数据\n        const selections = this.selections || []\n        const matched = selections.filter(s => load.indexOf(s[this.id]) >= 0) || []\n\n        // 没有匹配完全，请求远端数据来完成\n        if (matched.length !== load.length && this.remote && this.url) {\n          this.remoteMethod('', this.loadParams(load))\n        } else {\n          this._setSelectedAsLoad(load)\n        }\n      } else {\n        // 清空选择项\n        this.clear()\n      }\n    },\n    _setSelectedAsLoad (load) {\n      setTimeout(() => {\n        if (this.multiple) {\n          this.selected = load\n        } else {\n          this.selected = load.length > 0 ? load[0] : null\n        }\n      }, 1)\n    },\n    init () {\n      this.params = this.extraParams || {}\n      this.searchKey0 = this.searchKey || this.text\n      if (this.data) {\n        this.loadData(this.data)\n      } else if (this.remote && this.url) {\n        this.loadChanged(-1)\n      }\n    },\n    loadData (data) {\n      if (!(data instanceof Array)) {\n        this.selections = Object.entries(data)\n          .map(d => {\n            return {id: d[0], text: d[1]}\n          })\n      } else {\n        this.selections = data\n      }\n\n      // 将数据转化成map\n      this.mappedData = {}\n      this.selections.forEach((d) => {\n        this.mappedData[d[this.id]] = d\n      })\n\n      // 加载需要选择的项\n      const load = (this.load || []).filter(d => d != null)\n      this._setSelectedAsLoad(load)\n    },\n    getSelection () {\n      let selected = []\n      if (this.multiple) {\n        // 多选\n        this.selected.forEach(d => selected.push(this.mappedData[d]))\n      } else {\n        // 单选\n        const s = this.mappedData[this.selected]\n        selected = s ? [this.mappedData[this.selected]] : []\n      }\n      return selected\n    },\n    clear () {\n      this.selected = this.multiple ? [] : null\n    },\n    remoteMethod (text, loadParams) {\n      if (this.remote && this.url) {\n        text = (text || '').trim()\n\n        this.loading = true\n        let params = {}\n        params[this.searchKey0] = text\n        params = Object.assign(params, loadParams, this.params);\n        // 如果url是字符串，则自行请求结果，否则直接执行url方法\n        (typeof this.url === 'string' ? xhr.get(this.url, {params}).then((d) => {\n          this.loading = false\n          this.loadData(d.extra.data)\n        }) : this.url(params)\n          .then((d) => {\n            this.loading = false\n            this.loadData(d)\n          }))\n          .catch(() => {\n            this.loading = false\n            this.loadData([])\n          })\n      }\n    },\n    onChange () {\n      const selected = this.getSelection()\n      if (selected.length === 0) {\n        this.remoteMethod()\n      }\n      // 通知外部选择项已修改\n      if (this.onSelectionChanged) {\n        this.onSelectionChanged(selected)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n  @import 'index.scss';\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/selector/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-select',{staticClass:\"form-control\",staticStyle:{\"padding\":\"0\",\"border\":\"0\"},attrs:{\"multiple\":_vm.multiple,\"filterable\":_vm.filterable,\"remote\":_vm.remote,\"clearable\":_vm.clearable,\"placeholder\":_vm.placeholder || (_vm.multiple ? '请输入关键字搜索' : '请选择'),\"remote-method\":_vm.remoteMethod,\"loading\":_vm.loading,\"remove-tag\":_vm.onChange,\"clear\":_vm.remoteMethod,\"disabled\":_vm.disabledBol},on:{\"change\":_vm.onChange},model:{value:(_vm.selected),callback:function ($$v) {_vm.selected=$$v},expression:\"selected\"}},_vm._l((_vm.selections),function(item,index){return _c('el-option',{key:index,attrs:{\"label\":item[_vm.text],\"value\":item[_vm.id],\"disabled\":_vm.disabled.indexOf(item[_vm.id]) > -1}})}),1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-0a94b20b\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/selector/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0a94b20b\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0a94b20b\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-0a94b20b\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/selector/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}